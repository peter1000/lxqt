# Description: KDE Frameworks 5 is a collection of libraries based on top of Qt5 and QML derived from the monolithic KDE 4 libraries.
# URL: https://www.kde.org/
# Packager: pierre at nutyx dot org, tnut at nutyx dot org
# Depends on:  boost extra-cmake-modules docbook-xml docbook-xsl giflib libepoxy libgcrypt libjpeg-turbo libpng libxslt 
phonon-qt5 shared-mime-info wget avahi aspell libdbusmenu-qt5 polkit-qt5

section=frameworks
name=kf5
version=5.12.0
release=1

source=()

build() {
unset MAKEFLAGS
cat > frameworks-5.12.0.md5 << "EOF"
f12d5f866690b0954dfaa963e971eb27  attica-5.12.0.tar.xz
#e4042cf258b545267d74b0cf7d756150  extra-cmake-modules-5.12.0.tar.xz
0808423b1c23ca609904b711a5daccbe  kapidox-5.12.0.tar.xz
024f3f34236bd64823a5350ef8670557  karchive-5.12.0.tar.xz
7130e5d439afcfd0f558957a2ff33ee3  kcodecs-5.12.0.tar.xz
826d84426eb7cf9f2bccd49aca694f96  kconfig-5.12.0.tar.xz
65975642ab8272601df81b738da01e7d  kcoreaddons-5.12.0.tar.xz
d7eb58d52123a90f90533bf6691a3f40  kdbusaddons-5.12.0.tar.xz
e6100dd6dfbf53264a0c233ef357d823  kdnssd-5.12.0.tar.xz
154b8c8a475a18ef1936e53f91ca5dff  kguiaddons-5.12.0.tar.xz
146da9ecae1e489d462309092011edd2  ki18n-5.12.0.tar.xz
f87b44e5acd0c3a0ec891450a11f6c2b  kidletime-5.12.0.tar.xz
36e1a6fc39c73670b744429a1b3ef288  kimageformats-5.12.0.tar.xz
ce9f3e3adefc17848c51f06e96572947  kitemmodels-5.12.0.tar.xz
172fcd531af0df4329eaf35b91c7123d  kitemviews-5.12.0.tar.xz
9b2a7286c3576155037e2c1d7dc2dd0c  kplotting-5.12.0.tar.xz
c65b4f7bac1fcd3fc599d203ab7f15a0  kwidgetsaddons-5.12.0.tar.xz
001095e87ba8a52932f780bb043429d5  kwindowsystem-5.12.0.tar.xz
#984c2ca3a17b066b6be0220db610659b  networkmanager-qt-5.12.0.tar.xz
534592c079fb90cfe8734f91d90c8fbd  solid-5.12.0.tar.xz
070f07fbbfc7badf061d6cd46706a39e  sonnet-5.12.0.tar.xz
e7bec854878b5e1a874999691ff2ed19  threadweaver-5.12.0.tar.xz
890be635d70451258fe5472812114148  kauth-5.12.0.tar.xz
b778c5f541e35c076a5729a8e6765b63  kcompletion-5.12.0.tar.xz
47ae59a330ec700e0912382ddb951c25  kcrash-5.12.0.tar.xz
09617b8f4ce218626e8dc1a1bc0d43f5  kdoctools-5.12.0.tar.xz
6e36193e133d1300cd825c2eae5cbfd1  kpty-5.12.0.tar.xz
520741ddd15e3d20666fd6dfcb99e9cb  kunitconversion-5.12.0.tar.xz
31bb3396c6561e4de3fa858c51a0d82f  kconfigwidgets-5.12.0.tar.xz
93b2302fa2587bec638c3e619fac1bd5  kglobalaccel-5.12.0.tar.xz
e88e6a41687d499a10c0e72c0f7b384d  kpackage-5.12.0.tar.xz
88456f52f5511b6d26a03f747b51bd2b  kservice-5.12.0.tar.xz
fd182c27645b3bfbcd725bc7190d9b30  kdesu-5.12.0.tar.xz
007b1acc0aaf7bfadbcc14cec90d27eb  kemoticons-5.12.0.tar.xz
2a3eb21a34091008c75e87146320a324  kiconthemes-5.12.0.tar.xz
af26c7006f3e4404947314b9fdb64820  kjobwidgets-5.12.0.tar.xz
f2c365142e4700caa546f61f08d0f46e  knotifications-5.12.0.tar.xz
543c8c891e98c9c7c91bd16e762bc31f  ktextwidgets-5.12.0.tar.xz
eb3118489006cd6760740cc9f1f3be51  kwallet-5.12.0.tar.xz
bce712aaeb6e369dcb950753370da5a8  kxmlgui-5.12.0.tar.xz
baf1c82110ab626ef8f1cafc80571490  kbookmarks-5.12.0.tar.xz
0b0a52ff61f8354022d1aaf4514e9b70  kio-5.12.0.tar.xz
62cb010adb59c15129743ad57fdc198a  kdeclarative-5.12.0.tar.xz
d8b55927aa2636dbaf1b8c3dc6df03c4  kcmutils-5.12.0.tar.xz
87bdfb6972f8bd9b8b20cf1813bbb552  frameworkintegration-5.12.0.tar.xz
40d5cda2fc8f6b9bf57d86858414757b  kinit-5.12.0.tar.xz
30a5daedb40a6c826572d48a564b56fe  knewstuff-5.12.0.tar.xz
df52e0e67c18ae35276425204db07df6  knotifyconfig-5.12.0.tar.xz
ad9bd1946aaca8320f3e71f43184c699  kparts-5.12.0.tar.xz
3aa860c9df8888b13e2dc1f79ff5e704  kactivities-5.12.0.tar.xz
f9d80602631659b3960358470dfad836  kded-5.12.0.tar.xz
f95be7f48c904597b73cf0406712f4ab  kdewebkit-5.12.0.tar.xz
7d1d89fd57da9a1ca5c331b878bac196  ktexteditor-5.12.0.tar.xz
eb20c5371306630b8c480adac760ac80  kdesignerplugin-5.12.0.tar.xz
5d995245c69498886e7e2a546cc095eb  plasma-framework-5.12.0.tar.xz
#92a765aef34a5cb59969abcde487e5e0  modemmanager-qt-5.12.0.tar.xz
e5237301931919b484784be450536fd2  kpeople-5.12.0.tar.xz
72d803ac11a7000c4db00ddd45eacfab  kxmlrpcclient-5.12.0.tar.xz
#6f6ecffacfa14485e7ae09796c4fd381  bluez-qt-5.12.0.tar.xz
988bff4927d2230d8a98f2b9597cfd05  portingAids/kjs-5.12.0.tar.xz
bd02fae328a8e2e702933f09bfd95966  portingAids/kdelibs4support-5.12.0.tar.xz
36a415041b78ffcf2e652de43077f616  portingAids/khtml-5.12.0.tar.xz
370da9915046901f48e9e3e5cf69d202  portingAids/kjsembed-5.12.0.tar.xz
dc1a78386c65c9f8a18a597a5cecda9c  portingAids/kmediaplayer-5.12.0.tar.xz
400d20a5f3a0a0db7da20c406c76c06f  portingAids/kross-5.12.0.tar.xz
2caee0c50290dea30bc049e67bb84a23  portingAids/krunner-5.12.0.tar.xz
EOF
for package in $(grep -v '^#' list.md5 |cut -d " " -f 3)
	do
		wget http://download.kde.org/stable/$section/5.12/$package
		grep $package list.md5 |md5sum -c -
		packagedir=$(echo $package | sed 's/.tar.xz//')
		tar -xf $package
		
		while read -r line; do

		# Get the file name, ignoring comments and blank lines
		if $(echo $line | grep -E -q '^ *$|^#' ); then continue; fi
		file=$(echo $line | cut -d" " -f2)
    
		pkg=$(echo $file|sed 's|^.*/||')          # Remove directory
		packagedir=$(echo $pkg|sed 's|\.tar.*||') # Package directory

		tar -xf $file
    
		 pushd $packagedir

      mkdir build
      cd    build

      cmake -DCMAKE_INSTALL_PREFIX=$KF5_PREFIX \
            -DCMAKE_PREFIX_PATH=$QT5DIR        \
            -DCMAKE_BUILD_TYPE=Release         \
            -DLIB_INSTALL_DIR=lib              \
            -DBUILD_TESTING=OFF                \
            -Wno-dev .. 
      make
		make DESTDIR=$PKG install
		popd
	rm -rf $packagedir
  as_root /sbin/ldconfig

done < frameworks-5.12.0.md5
}
